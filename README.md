Part of the PHPStats project rewrite. This code is currently under heavy development. Please do not use.